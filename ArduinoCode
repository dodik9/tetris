#include <Adafruit_NeoPixel.h>

//Neo LED Matrix
//code by Sonja
//explanations by Jens

#define DATA_PIN 13
#define WIDTH 10
#define HEIGHT 20 
#define LED_LENGTH WIDTH * HEIGHT  // unsere Matrix
Adafruit_NeoPixel leds(LED_LENGTH, DATA_PIN, NEO_RGB + NEO_KHZ800); //muss so sein (schtecht in pdf file von LEDs)

class Box{
  public:
  int x;
  int y;
  int width;
  int height;

//globalle Classe mit Körper
  Box (int x, int y, int width, int height) :x(x), y(y), width(width), height(height){}

  void move(int dx, int dy){
    x+=dx;
    y+=dy;
    }
  };

Box box(0,0,2,2); //der Körper, seine Start Position x und y, seine größe x und y

void setup() {
  leds.begin();
  leds.setBrightness(250);
  Serial.begin(9600);
}

// Algotitm der Matrix
int
getPixelIndex (int x, int y)
{
  if(x<0 || y < 0 || x >= WIDTH || y >=HEIGHT) return -1;

  if (x % 2)
  {
    return (x * HEIGHT + HEIGHT - y - 1); //rechnet ungerade Bochen 1,3,5 
  }
  else
  {
    return (x * HEIGHT + y); //rechnet Gerade Boxen 0,2,4
  }
}

// wir machen ein Pixel  mit color  #FF00FF und koordinate (x,y)
void 
setPixel(uint32_t color1, int x, int y)
{
  int i = getPixelIndex(x, y);
  if(i<0) return;

  leds.setPixelColor (i, color1);
}

// das LED-Board frei machen von allem 
void clearLed() {
  for (int i = 0; i < WIDTH * HEIGHT; i++)
  {
    leds.setPixelColor (i, 0x0);
  }
  
}

void
drawBox(uint32_t color, int x, int y, int sideX, int sideY) {
  for (int i = x; i < x+ sideX; ++i){
    for (int j = y; j < y + sideY; j++){
      setPixel(color, i, j);
    }
  }
}

int dx = 1;
int dy = 0;
  

void loop() {
  clearLed();

  
  uint32_t color = 0xFF00FF;
  
  uint32_t color1 = 0xFF0000;
  //setPixel(color1, 0, 2); //auf der Koordinate die Position verändern. x1 = yAchse (von 0 bis 9), x2 = xAchse (0 bis 19)
  drawBox(color, box.x, box.y, box.width, box.height);
  
  leds.show();
  delay(200); //geschwindigkeit, bewegung

  box.move(dx,dy);

  //bewege dich 

    if (box.x == 8 && box.y == 0 ) { //Anzahl der Pixel am Rand, wenn Körper größer fällt sie raus.
      dx = 0; //addiere zu deiner Position die xAchse
      dy = 1; //addiere zu deiner Position die yAchse
      
    }else if (box.y == 18 && box.x == 8){
      dx = 0;
      dy = -1;
      
    }else if (box.x == 0 && box.y == 18){
      dx = 1;
      dy = 0;
      
    }else if(box.y == 0 && box.x == 0){
      dx = 0;
      dy = 1;
    }

}


